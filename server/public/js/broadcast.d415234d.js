(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["broadcast"],{"404d":function(e,t,r){},4595:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("h3",[e._v("Live Video Stream (broadcast)")]),r("video",{attrs:{mute:"true",playsinline:"",autoplay:"",id:"v",width:"50%",height:"50%"}}),e._v(" "+e._s(e.$route.params.id)+" ")])},a=[],c=(r("4ec9"),r("d3b7"),r("3ca3"),r("ddb0"),r("b85c")),o=(r("96cf"),r("1da1")),i=(r("8055"),{props:{userId:{required:!0}},data:function(){return{user:"hello"}},created:function(){this.user=this.$route.params.id,this.videoStream()},mounted:function(){},computed:{},methods:{videoStream:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var r,n,a,i,s,u,d,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return console.log(e.user),r={iceServers:[{urls:"turn:turn.circusfamilyprojects.nl:3478",username:"Dominique",credential:"WS7Yq_jT"}]},n=e.user,a="camera",i=new Map,u=function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(r,n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!s){t.next=2;break}return t.abrupt("return",s);case 2:return t.abrupt("return",new Promise((function(t,a){try{window.location.protocol;s=new WebSocket("wss://circusfamilyprojects.nl:4084/"+e.user);var c=function e(){s.send(JSON.stringify({type:"register",peerType:n,peerId:r})),s.removeEventListener("open",e),t(s)};s.addEventListener("open",c)}catch(o){a(o)}})));case 3:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}(),t.prev=6,console.log("in camera"),t.next=10,navigator.mediaDevices.getUserMedia({video:{width:{exact:1280},height:{exact:720},frameRate:{min:30,max:120}},audio:!0});case 10:return d=t.sent,window.v.srcObject=d,window.v.play(),t.next=15,u(n,a);case 15:l=t.sent,l.addEventListener("message",function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(t){var a,o,s,u,p,f,m;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a=JSON.parse(t.data),console.log("msg",a),"screens"!==a.type){e.next=20;break}console.log("vraag om beeld voor candidaten"),o=Object(c["a"])(a.screens),e.prev=5,u=regeneratorRuntime.mark((function e(){var t,a,o,u,p,f;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t=s.value,a=new RTCPeerConnection(r),i.set(t,a),o=Object(c["a"])(d.getTracks());try{for(o.s();!(u=o.n()).done;)p=u.value,a.addTrack(p,d)}catch(m){o.e(m)}finally{o.f()}return e.next=7,a.createOffer();case 7:return f=e.sent,e.next=10,a.setLocalDescription(f);case 10:a.onicecandidate=function(e){e.candidate&&l.send(JSON.stringify({type:"candidate",from:n,to:t,data:e.candidate}))},l.send(JSON.stringify({type:"offer",to:t,from:n,data:a.localDescription}));case 12:case"end":return e.stop()}}),e)})),o.s();case 8:if((s=o.n()).done){e.next=12;break}return e.delegateYield(u(),"t0",10);case 10:e.next=8;break;case 12:e.next=17;break;case 14:e.prev=14,e.t1=e["catch"](5),o.e(e.t1);case 17:return e.prev=17,o.f(),e.finish(17);case 20:"answer"===a.type&&(p=i.get(a.from),p.setRemoteDescription(a.data)),"disconnect"===a.type&&(f=i.get(a.from),f&&(console.log("Disconnecting from",a.from),f.close(),i.delete(a.from))),"candidate"===a.type&&(m=i.get(a.from),m&&(console.log("Adding candidate to",a.from),m.addIceCandidate(new RTCIceCandidate(a.data))));case 23:case"end":return e.stop()}}),e,null,[[5,14,17,20]])})));return function(t){return e.apply(this,arguments)}}()),t.next=22;break;case 19:t.prev=19,t.t0=t["catch"](6),console.log("error: "+t.t0);case 22:case"end":return t.stop()}}),t,null,[[6,19]])})))()}}}),s=i,u=(r("c65a"),r("2877")),d=Object(u["a"])(s,n,a,!1,null,"5939ec5a",null);t["default"]=d.exports},c65a:function(e,t,r){"use strict";var n=r("404d"),a=r.n(n);a.a}}]);
//# sourceMappingURL=broadcast.d415234d.js.map