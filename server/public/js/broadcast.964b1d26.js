(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["broadcast"],{4595:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("h3",[e._v("Live Video Stream (broadcast)")]),r("video",{attrs:{mute:"true",playsinline:"",autoplay:"",id:"v",width:"50%",height:"50%"}}),e._v(" "+e._s(e.$route.params.id)+" ")])},a=[],c=(r("4ec9"),r("d3b7"),r("3ca3"),r("ddb0"),r("b85c")),i=(r("96cf"),r("1da1")),o=(r("8055"),{props:{userId:{required:!0}},data:function(){return{user:"hello"}},created:function(){this.user=this.$route.params.id,this.videoStream()},mounted:function(){},computed:{},methods:{videoStream:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var r,n,a,o,s,u,d,p;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return console.log(e.user),r={iceServers:[{urls:"turn:turn.circusfamilyprojects.nl:3478",username:"Dominique",credential:"WS7Yq_jT"}]},n=e.user,a="camera",o=new Map,u=function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(r,n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!s){t.next=2;break}return t.abrupt("return",s);case 2:return t.abrupt("return",new Promise((function(t,a){try{window.location.protocol;s=new WebSocket("wss://circusfamilyprojects.nl:4084/"+e.user);var c=function e(){s.send(JSON.stringify({type:"register",peerType:n,peerId:r})),s.removeEventListener("open",e),t(s)};s.addEventListener("open",c)}catch(i){a(i)}})));case 3:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}(),t.prev=6,console.log("in camera"),t.next=10,navigator.mediaDevices.getUserMedia({video:{width:{exact:1280},height:{exact:720},frameRate:{min:30,max:120}},audio:!1});case 10:return d=t.sent,window.v.srcObject=d,window.v.play(),t.next=15,u(n,a);case 15:p=t.sent,p.addEventListener("message",function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){var a,i,s,u,f,l,m;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a=JSON.parse(t.data),console.log("msg",a),"screens"!==a.type){e.next=19;break}i=Object(c["a"])(a.screens),e.prev=4,u=regeneratorRuntime.mark((function e(){var t,a,i,u,f,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t=s.value,a=new RTCPeerConnection(r),o.set(t,a),i=Object(c["a"])(d.getTracks());try{for(i.s();!(u=i.n()).done;)f=u.value,a.addTrack(f,d)}catch(m){i.e(m)}finally{i.f()}return e.next=7,a.createOffer();case 7:return l=e.sent,e.next=10,a.setLocalDescription(l);case 10:a.onicecandidate=function(e){e.candidate&&p.send(JSON.stringify({type:"candidate",from:n,to:t,data:e.candidate}))},p.send(JSON.stringify({type:"offer",to:t,from:n,data:a.localDescription}));case 12:case"end":return e.stop()}}),e)})),i.s();case 7:if((s=i.n()).done){e.next=11;break}return e.delegateYield(u(),"t0",9);case 9:e.next=7;break;case 11:e.next=16;break;case 13:e.prev=13,e.t1=e["catch"](4),i.e(e.t1);case 16:return e.prev=16,i.f(),e.finish(16);case 19:"answer"===a.type&&(f=o.get(a.from),f.setRemoteDescription(a.data)),"disconnect"===a.type&&(l=o.get(a.from),l&&(console.log("Disconnecting from",a.from),l.close(),o.delete(a.from))),"candidate"===a.type&&(m=o.get(a.from),m&&(console.log("Adding candidate to",a.from),m.addIceCandidate(new RTCIceCandidate(a.data))));case 22:case"end":return e.stop()}}),e,null,[[4,13,16,19]])})));return function(t){return e.apply(this,arguments)}}()),t.next=22;break;case 19:t.prev=19,t.t0=t["catch"](6),console.error(t.t0);case 22:case"end":return t.stop()}}),t,null,[[6,19]])})))()}}}),s=o,u=(r("dd0e"),r("2877")),d=Object(u["a"])(s,n,a,!1,null,"63ca044a",null);t["default"]=d.exports},7390:function(e,t,r){},dd0e:function(e,t,r){"use strict";var n=r("7390"),a=r.n(n);a.a}}]);
//# sourceMappingURL=broadcast.964b1d26.js.map